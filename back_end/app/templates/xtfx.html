{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>心态分析</title>

    <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/echarts.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/echarts-wordcloud.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/map/js/china.js' %}"></script>
</head>
<body>
    {#--页面跳转--#}
    <nav class="navbar navbar-default">
        <div class="container">
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

                <ul class="nav navbar-nav">
                    <li><a href="/index/event_list/">首页</a></li>
                    <li><a href="/rdsj/event_list/">热点事件</a></li>
                    <li><a href="/xtfx/comment_list/">心态分析</a></li>
                    <li><a href="/xttz/">心态调整建议生成</a></li>
                </ul>

            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>
    {#1.心态列表#}
    <label>心态列表</label>
    {% for a,b in attitude_map.items %}
        <a href="/xtfx/{{b}}/attitude_detail/" >{{ a }}</a>
    {% endfor %}
    {#2.人工校正列表#}
    <form method="post">
    {% csrf_token %}
        <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>comment</th>
                    <th>attitude</th>
                    <th>change</th>
                  </tr>
                </thead>
                <tbody>
                {% for obj in queryset %}
                  <tr>
                    <th>{{ obj.content }}</th>
                    <th>{{ obj.get_attitude_display }}</th>
                    <td>
                            <div class="form-group">
                                <input name="comments_id" value="{{ obj.comments_id }}" type="hidden"/>
                                <input name="comments_time" value="{{ obj.time }}" type="hidden"/>
                                <div class="col-sm-4">
                                    {% for a in attitude_map.keys %}
                                        <label class="checkbox-inline">
                                            <input value="{{ a }}" type="checkbox" name="attitudes"/>{{ a }}
                                        </label>
                                    {% endfor %}
                                </div>
                            </div>
                            <span class="input-group-btn">
                                <button class="btn btn-default" type="submit">
                                    <span class="glyphicon glyphicon-search" aria-hidden="true">确定</span>
                                </button>
                            </span>
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
    </form>
    {#3.心态分布图#}
    <div id="map" style="width: 400px;height: 300px"></div>
    {#4.心态变化时间图#}
    <div id="pie" style="width: 400px;height: 300px"></div>
</body>
</html>

<script type="text/javascript" src="{% static 'js/attitude_map.js' %}"></script>
<script type="text/javascript" src="{% static 'js/attitude_pie.js' %}"></script>
<script type="text/javascript" src="{% static 'js/attitude_column_hot.js' %}"></script>
<script type="text/javascript" src="{% static 'js/attitude_wordcloud.js' %}"></script>
<script>
    var mapOption;
    var pieOption;

    {#1.心态分布图#}
    $.ajax({
        url:'/index/attitude_map/',
        type:'get',
        data:{},
        success:function (data) {
            mapOption =create_attitude_map(data)
            console.log(mapOption)
            if (document.readyState === "complete") {
                var MapEchart = echarts.init(document.getElementById('map'));
                MapEchart.setOption(mapOption);
            }
        }
    })

   {#2.心态变化时间图（饼图）#}
    $.ajax({
        url:'/index/attitude_pie/',
        type:'get',
        //$("#add1").val() 取到id为add1这个控件的value值
        data:{},
        success:function (data) {
            console.log(data)
            pieOption =create_attitude_pie(data)
            if (document.readyState === "complete") {
                var PieEchart = echarts.init(document.getElementById('pie'));
                PieEchart.setOption(pieOption);
            }
        }
    })
</script>